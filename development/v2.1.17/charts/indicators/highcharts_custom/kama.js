KAMA=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.CalculateKAMAValue=function(a,b){for(var c=2/(this.options.fastPeriod+1),d=2/(this.options.slowPeriod+1),e=Math.abs(this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo)-this.indicators.getIndicatorOrPriceValue(this.priceData[b-this.options.period],this.options.appliedTo)),f=0,g=0;g<this.options.period;g++)f+=Math.abs(this.indicators.getIndicatorOrPriceValue(a[b-g],this.options.appliedTo)-this.indicators.getIndicatorOrPriceValue(this.priceData[b-(g+1)],this.options.appliedTo));var h=e/f,i=Math.pow(h*(c-d)+d,2),j=this.indicators.getIndicatorOrPriceValue(a[b],this.options.appliedTo),k=this.indicatorData[b-1].value,l=toFixed(k+i*(j-k),4);return l};for(var d=0;d<a.length;d++){if(d>this.options.period-1){var e=this.CalculateKAMAValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else if(d===this.options.period-1){var e=toFixed(c.getIndicatorOrPriceValue(a[d],this.options.appliedTo),4);this.indicatorData.push({time:a[d].time,value:null})}else this.indicatorData.push({time:a[d].time,value:null});this.priceData.push(a[d])}},KAMA.prototype=Object.create(IndicatorBase.prototype),KAMA.prototype.constructor=KAMA,KAMA.prototype.addPoint=function(a){this.priceData.push(a);var b=this.CalculateKAMAValue(this.priceData,this.priceData.length-1);return this.indicatorData.push({time:a.time,value:b}),[{id:this.uniqueID,value:b}]},KAMA.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.CalculateKAMAValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},KAMA.prototype.toString=function(){return"KAMA ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"};