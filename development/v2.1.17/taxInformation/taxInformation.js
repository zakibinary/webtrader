define(["exports","common/rivetsExtra","jquery","windows/windows","text!./taxInformation.html","websockets/binary_websockets","lodash","css!taxInformation/taxInformation.css","common/util","jquery-growl"],function(a,b,c,d,e,f,g){"use strict";function h(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.init=void 0;var i=h(b),j=h(c),k=h(d),l=h(e),m=h(f),n=h(g),o=null,p=a.init=function(){Promise.all([m["default"].cached.send({get_settings:1}),m["default"].send({residence_list:1})]).then(function(a){o=k["default"].createBlankWindow(j["default"](l["default"]).i18n(),{title:"Tax Information".i18n(),width:700,height:"auto",resizable:!1,collapsable:!1,minimizable:!1,maximizable:!1,closable:!0,closeOnEscape:!1,modal:!0,ignoreTileAction:!0,"data-authorized":"true",close:function(){o.dialog("destroy"),o=null}});var b={empty_fields:{show:function(){b.empty_fields.validate=!0,b.empty_fields.clear()},clear:n["default"].debounce(function(){b.empty_fields.validate=!1},4e3),validate:!1},place_of_birth:a[1].residence_list[0].value,tax_residence:"",tax_identification_number:null,country_array:a[1].residence_list,submit_disabled:!1,cancel:function(){m["default"].invalidate(),o.dialog("close")},submit:function(){if(!b.isValid())return void b.empty_fields.show();b.submit_disabled=!0;var c=a[0].get_settings;m["default"].send({address_line_1:c.address_line_1,address_city:c.address_city,phone:c.phone,place_of_birth:b.place_of_birth,set_settings:1,tax_identification_number:b.tax_identification_number,tax_residence:b.tax_residence.join(",")}).then(function(){j["default"].growl.notice({message:"Tax Information successfully updated".i18n()}),o.dialog("close")})["catch"](function(a){j["default"].growl.error({message:a.msg})})},isValid:function(){return b.place_of_birth&&b.tax_residence&&b.tax_identification_number&&/^[\w-]{0,20}$/.test(b.tax_identification_number)}};i["default"].bind(o,b),o.dialog("open")})["catch"](function(a){j["default"].growl.error({message:a.msg})})};a["default"]={init:p}});