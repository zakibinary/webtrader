CHOP=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.calculateCHOPValue=function(a,b){for(var c=0,d=a[b].high,e=a[b].low,f=0;f<this.options.period;f++)c+=this.atr.indicatorData[b-f].value,d=Math.max(a[b-f].high,d),e=Math.min(a[b-f].low,e);var g=0;return d-e!==0&&(g=100*Math.log10(c/(d-e))/Math.log10(this.options.period)),toFixed(g,4)},this.atr=new ATR(a,{period:this.options.atrPeriod,appliedTo:this.options.appliedTo},c);for(var d=0;d<a.length;d++){if(d>=b.period){var e=this.calculateCHOPValue(a,d);this.indicatorData.push({time:a[d].time,value:e})}else this.indicatorData.push({time:a[d].time,value:0});this.priceData.push(a[d])}},CHOP.prototype=Object.create(IndicatorBase.prototype),CHOP.prototype.constructor=CHOP,CHOP.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1;this.atr.addPoint(a)[0].value;var c=this.calculateCHOPValue(this.priceData,b);return this.indicatorData.push({time:a.time,value:c}),[{id:this.uniqueID,value:c}]},CHOP.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close,this.atr.update(a)[0].value;var c=this.calculateCHOPValue(this.priceData,b);return this.indicatorData[b].value=c,[{id:this.uniqueID,value:c}]},CHOP.prototype.toString=function(){return"CHOP ("+this.options.period+", "+this.options.atrPeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"};