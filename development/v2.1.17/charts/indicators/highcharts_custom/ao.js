AO=function(a,b,c){b.shortMaType=(b.shortMaType||"SMA").toUpperCase(),b.longMaType=(b.longMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c);var d={maType:b.shortMaType,period:b.shortPeriod},e={maType:b.longMaType,period:b.longPeriod};this.getBarColor=function(a){var b=this.options.aoHighStroke;return a>1&&this.indicatorData[a].value<this.indicatorData[a-1].value&&(b=this.options.aoLowStroke),b};for(var f=[],g=0;g<a.length;g++){var h=(a[g].high+a[g].low)/2;f.push({time:a[g].time,close:h})}this.shortMa=new window[b.shortMaType](f,d,c),this.longMa=new window[b.longMaType](f,e,c);var g=0,i=this;this.shortMa.indicatorData.forEach(function(b){var c=toFixed(b.value-i.longMa.indicatorData[g].value,4);i.indicatorData.push({time:a[g].time,value:c}),g++})},AO.prototype=Object.create(IndicatorBase.prototype),AO.prototype.constructor=AO,AO.prototype.addPoint=function(a){var b=(a.high+a.low)/2,c=this.shortMa.addPoint({time:a.time,close:b})[0].value,d=this.longMa.addPoint({time:a.time,close:b})[0].value,e=toFixed(c-d,4);return this.indicatorData.push({time:a.time,value:e}),[{id:this.uniqueID,value:e,color:this.getBarColor(this.indicatorData.length-1)}]},AO.prototype.update=function(a){var b=this.indicatorData.length-1,c=(a.high+a.low)/2,d=this.shortMa.update({time:a.time,close:c})[0].value,e=this.longMa.update({time:a.time,close:c})[0].value,f=toFixed(d-e,4);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},AO.prototype.toString=function(){return"AO ("+this.options.shortPeriod+", "+this.options.longPeriod+")"},AO.prototype.buildSeriesAndAxisConfFromData=function(a){for(var b=[],c=0;c<this.indicatorData.length;c++){var d=this.indicatorData[c];b.push({x:d.time,y:d.value,color:this.getBarColor(c)})}return[{axisConf:{id:a.id+"-"+this.uniqueID,title:{text:this.toString(),align:"high",offset:0,rotation:0,y:10,x:30+7.5*this.toString().length},lineWidth:2,plotLines:this.options.levels}},{seriesConf:{id:this.uniqueID,name:this.toString(),data:b,type:"column",yAxis:a.id+"-"+this.uniqueID,onChartIndicator:!1}}]};