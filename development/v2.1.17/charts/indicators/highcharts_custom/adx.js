ADX=function(a,b,c){IndicatorBase.call(this,a,b,c),this.priceData=[],this.atr=new ATR(a,b,c),this.calculateDMValue=function(a,b){var c=a[b].high-a[b-1].high,d=a[b].low-a[b-1].low,e=0,f=0;return c>d&&c>0&&(e=c),d>c&&d>0&&(f=d),{plusDm:e,minusDM:f}},this.calculateDMData=function(a){for(var b=[{time:a[0].time,close:0}],c=[{time:a[0].time,close:0}],d=1;d<a.length;d++){var e=this.calculateDMValue(a,d);0===this.atr.indicatorData[d].value?(b.push({time:a[0].time,close:0}),c.push({time:a[0].time,close:0})):(b.push({time:a[d].time,close:e.plusDm/this.atr.indicatorData[d].value}),c.push({time:a[d].time,close:e.minusDM/this.atr.indicatorData[d].value}))}return{plusDMData:b,minusDMData:c}};var d=this.calculateDMData(a);this.PlusDI=new window[this.options.maType](d.plusDMData,{maType:this.options.maType,period:this.options.period},c),this.MinusDI=new window[this.options.maType](d.minusDMData,{maType:this.options.maType,period:this.options.period},c);var e=[],f=0,g=this;this.PlusDI.indicatorData.forEach(function(b){var c=g.MinusDI.indicatorData[f];e.push(b.value+c.value===0?{time:b.time,close:0}:{time:b.time,close:Math.abs((b.value-c.value)/(b.value+c.value))}),g.priceData.push(a[f]),f++}),this.adxdata=new window[this.options.maType](e,{maType:this.options.maType,period:this.options.period},c),this.indicatorData=this.adxdata.indicatorData},ADX.prototype=Object.create(IndicatorBase.prototype),ADX.prototype.constructor=ADX,ADX.prototype.addPoint=function(a){this.priceData.push(a);var b=this.priceData.length-1,c=this.atr.addPoint(a)[0].value,d=this.calculateDMValue(this.priceData,b),e=this.PlusDI.addPoint({time:a.time,close:0===c?0:d.plusDm/c})[0].value,f=this.MinusDI.addPoint({time:a.time,close:0===c?0:d.minusDM/c})[0].value,g=e+f===0?0:Math.abs((e-f)/(e+f)),h=this.adxdata.addPoint({time:a.time,close:g})[0].value;return this.indicatorData=this.adxdata.indicatorData,[{id:this.uniqueID,value:h}]},ADX.prototype.update=function(a){var b=this.priceData.length-1;this.priceData[b].open=a.open,this.priceData[b].high=a.high,this.priceData[b].low=a.low,this.priceData[b].close=a.close;var c=this.atr.update(a)[0].value,d=this.calculateDMValue(this.priceData,b),e=this.PlusDI.update({time:a.time,close:0===c?0:d.plusDm/c})[0].value,f=this.MinusDI.update({time:a.time,close:0===c?0:d.minusDM/c})[0].value,g=e+f===0?0:Math.abs((e-f)/(e+f)),h=this.adxdata.update({time:a.time,close:g})[0].value;return this.indicatorData=this.adxdata.indicatorData,[{id:this.uniqueID,value:h}]},ADX.prototype.toString=function(){return"ADX ("+this.options.period+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"};