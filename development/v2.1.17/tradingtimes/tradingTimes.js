define(["exports","jquery","windows/windows","websockets/binary_websockets","navigation/menu","datatables","jquery-growl"],function(a,b,c,d,e){"use strict";function f(a){return a&&a.__esModule?a:{"default":a}}Object.defineProperty(a,"__esModule",{value:!0}),a.init=void 0;var g=f(b),h=f(c),i=f(d),j=f(e),k=null,l=null,m=function(a){a=a||[];var b=[],c={};a.forEach(function(a){b.push(a.display_name),c[a.display_name]=[],a.submarkets.forEach(function(b){return c[a.display_name].push(b.display_name)})});var d=function(b,c){var d=a.filter(function(a){return a.display_name==b})[0],e=d&&d.submarkets.filter(function(a){return a.display_name==c})[0].instruments,f=(e||[]).map(function(a){return[a.display_name,a.times.open[0],a.times.close[0],a.times.settlement||a.settlement||"-",a.events[0]?a.events[0].descrip+":"+a.events[0].dates:"-"]});return f};return{market_names:b,submarket_names:c,getRowsFor:d}},n=a.init=function(a){require(["css!tradingtimes/tradingTimes.css"]),a.click(function(){l?l.moveToTop():(l=h["default"].createBlankWindow(g["default"]("<div/>"),{title:"Trading Times".i18n(),dialogClass:"tradingTimes",width:700,height:400}),l.track({module_id:"tradingTimes",is_unique:!0,data:null}),l.dialog("open"),require(["text!tradingtimes/tradingTimes.html"],o))})},o=function(a){a=g["default"](a).i18n();var b=a.filter(".trading-times-sub-header");k=a.filter("table"),a.appendTo(l),k=k.dataTable({data:[],columnDefs:[{className:"dt-body-center dt-header-center",targets:[0,1,2,3,4]}],paging:!1,ordering:!1,searching:!0,processing:!0}),k.parent().addClass("hide-search-input"),k.api().columns().every(function(){var a=this;g["default"]("input",this.header()).on("keyup change",function(){a.search()!==this.value&&a.search(this.value).draw()})});var c=null,d=null,e=function(a){var e=g["default"]("#"+k.attr("id")+"_processing").show(),f=function(a,b,c){var d=a.getRowsFor(b,c);k.api().rows().remove(),k.api().rows.add(d),k.api().draw()},l=function(a){a=j["default"].extractChartableMarkets(a);var i=m(a);if(isChampionFx()&&_.remove(i.market_names,function(a){return"Volatility Indices"===a}),null==c){var k=g["default"]("<select />");k.appendTo(b),c=h["default"].makeSelectmenu(k,{list:i.market_names,inx:0,changed:function(a){d.update_list(i.submarket_names[a]),f(i,c.val(),d.val())}})}if(null==d){var l=g["default"]("<select />");l.appendTo(b),d=h["default"].makeSelectmenu(l,{list:i.submarket_names[c.val()],inx:0,changed:function(){return f(i,c.val(),d.val())}})}f(i,c.val(),d.val()),e.hide()};i["default"].cached.send({trading_times:a}).then(l)["catch"](function(a){g["default"].growl.error({message:a.message}),l({})})};e((new Date).toISOString().slice(0,10)),l.addDateToHeader({title:"Date: ",date:new Date,changed:e})};a["default"]={init:n}});