MASS=function(a,b,c){b.singleMaType=(b.singleMaType||"SMA").toUpperCase(),b.doubleMaType=(b.doubleMaType||"SMA").toUpperCase(),IndicatorBase.call(this,a,b,c),this.calculateMassValue=function(a){for(var b=0,c=0;c<this.options.period;c++)b+=this.ratioData[a-c].value;return toFixed(b,4)};for(var d=[],e=0;e<a.length;e++){var f=a[e].high-a[e].low;d.push({time:a[e].time,close:f})}this.singleMA=new window[b.singleMaType](d,{maType:b.singleMaType,period:b.singlePeriod},c),singleMAData=[],this.singleMA.indicatorData.forEach(function(a){singleMAData.push({time:a.time,close:a.value})}),this.doubleMA=new window[b.doubleMaType](singleMAData,{maType:b.doubleMaType,period:b.doublePeriod},c);var e=0,g=this;this.ratioData=[],this.singleMA.indicatorData.forEach(function(b){var c=0;0!==g.doubleMA.indicatorData[e].value&&(c=b.value/g.doubleMA.indicatorData[e].value),g.ratioData.push({time:a[e].time,value:c}),e++});for(var e=0;e<a.length;e++)if(e>=this.options.period){var h=this.calculateMassValue(e);this.indicatorData.push({time:a[e].time,value:h})}else this.indicatorData.push({time:a[e].time,value:0})},MASS.prototype=Object.create(IndicatorBase.prototype),MASS.prototype.constructor=MASS,MASS.prototype.addPoint=function(a){var b=this.indicatorData.length-1,c=a.high-a.low,d=this.singleMA.addPoint({time:a.time,close:c})[0].value,e=this.doubleMA.addPoint({time:a.time,close:d})[0].value;this.ratioData.push({time:a.time,value:0!==e?d/e:0});var f=this.calculateMassValue(b);return this.indicatorData.push({time:a.time,value:f}),[{id:this.uniqueID,value:f}]},MASS.prototype.update=function(a){var b=this.indicatorData.length-1,c=a.high-a.low,d=this.singleMA.update({time:a.time,close:c})[0].value,e=this.doubleMA.update({time:a.time,close:d})[0].value;this.ratioData[b].value=0!==e?d/e:0;var f=this.calculateMassValue(b);return this.indicatorData[b].value=f,[{id:this.uniqueID,value:f}]},MASS.prototype.toString=function(){return"MASS ("+this.options.singlePeriod+", "+this.options.doublePeriod+", "+this.indicators.appliedPriceString(this.options.appliedTo)+")"};